<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <title>e!Peek</title>

    <!-- Remote D3.js -->
    <script src="http://d3js.org/d3.v3.min.js"></script>

    <!-- Local jqTouch -->
    <link rel="stylesheet" href="lib/jqtouch-1.0-b4-rc/themes/css/apple.css" title="jQTouch">
    <!-- <style type="text/css" media="screen">@import "lib/jqtouch-1.0-b4-rc/themes/css/jqtouch.css";</style> -->
    <script src="lib/jqtouch-1.0-b4-rc/src/lib/zepto.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="lib/jqtouch-1.0-b4-rc/src/jqtouch.js" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript" charset="utf-8">
      var jQT = new $.jQTouch({
      statusBar: 'black',
      icon: 'apple-touch-icon.png',
      statusBar: 'black-translucent',    <!-- We should change this -->
      startupScreen: 'jqt_startup.png',  <!-- We should change this -->
      preloadImages: []
      });
</script>

    <!-- Full screen mode in iPhone -->
    <meta name="apple-mobile-web-app-capable" content="yes"></meta>

    <!-- Startup graphic -->
    <link rel="apple-touch-startup-image" href="apple-touch-startup-graphic.png" />
  </head>

  <body>
    <div id="Options">
      <div class="toolbar">
    	<h1>Options</h1>
      </div>
      <ul class="edgetoedge">
    	<li class="arrow"><a href="#search">Search</a></li>
    	<li class="arrow"><a href="#ensGenes">Ensembl Genes <small class="counter" id="ePeek_ext_n_ensGenes"></small></a></li>
    	<li class="arrow"><a href="#orthologues">Orthologues <small class="counter" id="ePeek_ext_n_orthologues"></small></a></li>
	<!-- <li class="arrow"><a href="#browser" id="return_to_origin">Return to origin <small class="counter" id="ePeek_origin"></small></a></li> -->
    	<li class="arrow"><a href="#browser">Browser</a></li>
      </ul>
    </div>

    <div id="search">
      <div class="toolbar">
	<h1>Search</h1>
	<a class="button back" href="#">Back</a>
      </div>
      <form method="get"> <!-- Needed?? -->
	<ul>
	  <li><input type="text" placeholder="BRCA2" name="location" id="ePeek_loc"  autocapitalize="off" autocorrect="off" autocomplete="off" /></li>
	  <li><input type="submit" class="submit" name="action" value="Jump!" onclick="var val=$('#ePeek_loc').val(); window.location.href='ePeek_mobile.html?loc=' + val + '#browser'"/></li>
	</ul>
      </form>
      <ul class="edgetoedge">
	<li>Examples:</li>
	<li>ENSG00000139618</li>
	<li>SNORD73</li>
	<li>human:5:1533225-1555555</li>
      </ul>
    </div>

    <div id="ensGenes">
      <div class="toolbar">
	<h1>Ensembl Genes</h1>
	<a class="button back" href="#">Back</a>
	<a class="button" href="#browser">Browser</a>
      </div>
      <ul class="edgetoedge">
	<li><div id="ePeek_ext_ensGenes_select"></div></li>
      </ul>
    </div>
      
    <div id="orthologues">
      <div class="toolbar">
	<h1>Orthologues</h1>
	<a class="button back" href="#">Back</a>
	<a class="button" href="#browser">Browser</a>
      </div>
      <ul class="edgetoedge">
	<li><div id="ePeek_ext_orth_select"></div></li>
      </ul>
    </div>

    <div id="browser">
      <div class="toolbar">
    	<h1>e!Peek</h1>
    	<a class="button back" href="#">Options</a>
      </div>
      <ul class="edgetoedge">
    	<li><div id="GenomeBrowser"></div></li>
      </ul>
    </div>

    <!-- -->
    <link rel="stylesheet" href="../lib/ePeek.css" type="text/css" />
    <script src="../lib/minimalGenomeBrowser.js"></script>

    <script>
      var changes = 0;

      function getLoc() {
        var url = document.createElement("a");
        url.href=document.URL;
        var loc = url.search;
        if (loc.indexOf("loc=") === 1) {   <!-- Search term starts by "loc=" -->
          loc = loc.substring(5);
          console.log("LOC TO PARSE IS: " + loc);
        }
        return loc;
      }

      function getGB(w) {
        var gB = genomeBrowser()
          .show_options(false)
          .show_title(false)
          .show_links(false)
          .background_color("#FFFFFF")
          .foreground_color("#7389A5")
          .width(w-20)
          .orthologues_div_id("ePeek_ext_orth_select")
          .ensGenes_div_id("ePeek_ext_ensGenes_select")
          .n_orthologues_div_id("ePeek_ext_n_orthologues")
          .n_ensGenes_div_id("ePeek_ext_n_ensGenes");
        return gB;
      }

      (function() {

      var w = document.documentElement.clientWidth;;

      var gB = getGB(w);
      var loc = getLoc();

      if (gB.isLocation(loc)) {
          gB.parseLocation(loc);
      } else {
          gB.gene(loc);
      }

      gB(document.getElementById("GenomeBrowser"));

      window.onorientationchange = function() {
        var w = document.documentElement.clientWidth;
        gB.resize(w-20);
      };

      d3.select("#return_to_origin")
        .on("click", function(){gB.startOnOrigin()});
	
      })();


    </script>

  </body>
  
</html>

